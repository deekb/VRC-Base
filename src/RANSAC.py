from LinearRegressor import LinearRegressor
from Utilities import distance_from_point_to_line
import matplotlib.pyplot as plt
import random
import math
import time


class RANSAC:
    def __init__(
        self,
        sample_count=500,
        default_sample_size=2,
        inlier_distance_threshold=40,
        score_threshold=1,
        sample: callable = None,
        score_model: callable = None,
        compare: callable = None,
    ):
        self.default_sample_size = default_sample_size  # `sample_points`: Minimum number of data points to estimate parameters
        self.sample_count = sample_count  # `sample_count`: Maximum iterations allowed
        self.score_threshold = score_threshold  # `score_threshold`: Threshold value to determine if points are fit well
        self.inlier_distance_threshold = inlier_distance_threshold  # `inlier_distance_threshold`: Maximum distance from the line to consider a point an inlier

        if sample is not None:
            self.sample = sample
        else:
            self.sample = self._sample

        if score_model is not None:
            self.score_model = score_model
        else:
            self.score_model = self._score_model

        if compare is not None:
            self.compare = compare
        else:
            self.compare = self._compare

        self.best_model = None
        self.best_inliers = set()
        self.best_error = math.inf
        self.point_list = []

    def fit(self, point_list):
        self.point_list = point_list
        sample_number = 0

        while sample_number < self.sample_count:
            sample_points = self.sample(self, point_list, self.default_sample_size)
            sample_model = LinearRegressor().smart_fit(sample_points)
            inliers = set()

            for point in self.point_list:
                distance = distance_from_point_to_line(
                    point,
                    sample_model.slope,
                    sample_model.x_intercept,
                    sample_model.y_intercept,
                )
                if distance < self.inlier_distance_threshold:
                    inliers.add((point[0], point[1]))

            if self.score_model(self, sample_model, inliers) >= self.score_threshold:
                # Found an acceptable model
                # print("Found a good model")
                # print(f"Inlier count: {len(inliers)}")
                # print(f"Inliers: {inliers}")
                # print(f"Sample points: {sample_points}")
                refined_model = LinearRegressor().smart_fit(inliers)

                for point in self.point_list:
                    distance = distance_from_point_to_line(
                        point,
                        refined_model.slope,
                        refined_model.x_intercept,
                        refined_model.y_intercept,
                    )
                    if distance < self.inlier_distance_threshold:
                        inliers.add((point[0], point[1]))

                refined_model_error = self._model_error(self, refined_model, inliers)

                if self.compare(
                    self,
                    refined_model,
                    refined_model_error,
                    inliers,
                    self.best_model,
                    self.best_error,
                    self.best_inliers,
                ):
                    # print(f"Inliers: {len(self.best_inliers)} -> {len(inliers)}")
                    # print(f"Error: {self.best_error} -> {refined_model_error}")
                    self.best_error = refined_model_error
                    self.best_model = refined_model
                    self.best_inliers = inliers
                    # print(f"Found new best model: {self.best_model.slope, self.best_model.x_intercept, self.best_model.y_intercept}")

            sample_number += 1

        if self.best_model:
            print(
                f"Returning best model: {self.best_model.slope, self.best_model.x_intercept, self.best_model.y_intercept}"
            )
        return self.best_model, self.best_inliers

    @staticmethod
    def _sample(self, point_list, default_sample_points):
        return random.sample(point_list, default_sample_points)

    @staticmethod
    def _score_model(self, model, inliers):
        return len(inliers)

    @staticmethod
    def _model_error(self, model, inliers):
        sum_distance_errors = sum(
            [
                distance_from_point_to_line(
                    point[:2], model.slope, model.x_intercept, model.y_intercept
                )
                ** 2
                for point in inliers
            ]
        )
        return math.sqrt(sum_distance_errors) / len(inliers)

    @staticmethod
    def _compare(
        self,
        model,
        model_error,
        model_inliers,
        reference_model,
        reference_error,
        reference_model_inliers,
    ):
        return all(
            (
                model_error <= reference_error,
                len(model_inliers) >= len(reference_model_inliers),
            )
        )


def sample(self, point_list, default_sample_points):
    return random.sample(point_list, default_sample_points)


def score_model(self, model, inliers):
    horizontal_vertical_threshold = 20
    if not (
        -1 / horizontal_vertical_threshold
        <= model.slope
        <= 1 / horizontal_vertical_threshold
        or -horizontal_vertical_threshold >= model.slope
        or model.slope >= horizontal_vertical_threshold
    ):
        return 0
    return len(inliers)


def compare(
    self,
    model,
    model_error,
    model_inliers,
    reference_model,
    reference_error,
    reference_model_inliers,
):
    global optimal_model, optimal_model_position_error
    if reference_model is None:
        return model

    reference_model_matches_optimal = False
    new_model_matches_optimal = False

    if reference_model.slope > 1:
        y_list = [44, 712 + 44]
        x_list = reference_model.predict_x(y_list)
        for x in x_list:
            if abs(x - optimal_model.x_intercept) < optimal_model_position_error:
                reference_model_matches_optimal = True
                print("Reference model matches optimal model")

    if model.slope > 1:
        y_list = [44, 712 + 44]
        x_list = model.predict_x(y_list)
        for x in x_list:
            if abs(x - optimal_model.x_intercept) < optimal_model_position_error:
                new_model_matches_optimal = True
                print("New model matches optimal model")

    if not any((reference_model_matches_optimal, new_model_matches_optimal)):
        # Neither model matches optimal, compare using other metrics
        return model_error <= reference_error and len(model_inliers) >= len(
            reference_model_inliers
        )
    elif not reference_model_matches_optimal:
        # Reference model does not match optimal, use new model
        return model
    elif not new_model_matches_optimal:
        # The reference model matches optimal, new model does not; use the reference model
        return reference_model
    else:
        # Both models matched the optimal model, compare using other metrics
        return model_error <= reference_error and len(model_inliers) >= len(
            reference_model_inliers
        )


if __name__ == "__main__":
    # Full point list
    # point_list = [
    #     (356.0, 588.35),
    #     (359.70928298318654, 592.1208667605497),
    #     (367.17830388692875, 711.69939717015),
    #     (372.34122775117464, 702.5148976242995),
    #     (378.33929708554143, 711.0729593065681),
    #     (384.26096628116926, 715.0896236106664),
    #     (388.9873165259727, 704.9693576424997),
    #     (396.0228466126826, 718.5224094784006),
    #     (400.75649770581265, 710.2841598393971),
    #     (405.79449536674025, 705.874360637021),
    #     (412.1951707040762, 710.8023441502837),
    #     (419.3042947228781, 718.7172538901852),
    #     (422.19713391026954, 703.0175285011653),
    #     (428.13144095831154, 704.3095537381625),
    #     (435.6659117580154, 712.4048014600219),
    #     (440.48971331354846, 707.9249834399288),
    #     (445.4661869075573, 704.4477922160281),
    #     (452.57093946107886, 709.0039012200982),
    #     (458.45250891525507, 708.6438487227123),
    #     (465.8240614742657, 712.9886910271767),
    #     (473.4805358364921, 717.567911082499),
    #     (478.4083923370797, 713.5256571009265),
    #     (480.6978968902991, 702.3617330712775),
    #     (491.42504952293007, 714.3919943116985),
    #     (494.04670725675453, 704.6661822080949),
    #     (504.1463237543327, 713.6568640234253),
    #     (470.2991629246891, 620.1297812718478),
    #     (473.32274363831937, 615.8410741687717),
    #     (473.72797411774053, 606.1846800068499),
    #     (476.3123644763457, 601.5880912811327),
    #     (481.4716243655176, 602.2519281225607),
    #     (488.79848128714934, 606.8126858191685),
    #     (491.2041686366442, 601.9354697543063),
    #     (492.8085248208996, 595.8508769242474),
    #     (498.20071948986623, 596.4482852435515),
    #     (499.59566804805957, 590.3268331686114),
    #     (501.83865792341055, 585.8049531235142),
    #     (511.1538483662756, 592.1991603226784),
    #     (508.170022469017, 579.911388470479),
    #     (516.2539637444631, 584.0183262463557),
    #     (515.7159476791694, 575.8301427965284),
    #     (521.956150280073, 577.0328396058297),
    #     (528.87043448282, 578.8632212405606),
    #     (525.9722161248636, 568.1600062349274),
    #     (536.5344094965731, 574.2286131851732),
    #     (540.784205951147, 572.3545073623503),
    #     (543.3165858529212, 568.4689604728237),
    #     (548.1618979198777, 567.1831683937669),
    #     (545.7735714410803, 558.0883277369002),
    #     (552.3343977386103, 558.6013817564431),
    #     (557.0304578913372, 557.0304578913368),
    #     (559.7503838328645, 553.4478582131578),
    #     (566.2527763640202, 553.4404990274813),
    #     (568.5145043647285, 549.3733204441949),
    #     (570.5130131375669, 545.1186606859277),
    #     (571.6131115458907, 540.150994104025),
    #     (581.933745612931, 542.9086493940595),
    #     (587.5341910971019, 541.4938650683973),
    #     (588.9179437730411, 536.6696767405534),
    #     (591.1272817116652, 532.5385567514415),
    #     (592.3138640569184, 527.6920721946284),
    #     (597.0269067534144, 525.3965472519513),
    #     (598.6654404921542, 520.9152630618132),
    #     (709.3166668344107, 588.0856707382654),
    #     (718.9765751733253, 586.3519391614759),
    #     (703.5361309907246, 568.9704149782183),
    #     (717.8559481524641, 570.0010111814594),
    #     (716.4603627039947, 561.6029609327416),
    #     (708.647715716646, 549.8697223003793),
    #     (586.4197939048726, 478.00100082308677),
    #     (588.396776671426, 474.41207209456456),
    #     (592.315956561405, 471.76999254758346),
    #     (704.9691734598225, 520.2124282743548),
    #     (715.0017506667136, 518.0955058545576),
    #     (710.1385661858035, 509.2494422986948),
    #     (710.8621284375787, 502.9887063714283),
    #     (717.7760306591193, 499.2372634496085),
    #     (717.5491179157492, 492.61802712068504),
    #     (717.0159510477395, 485.9737399981196),
    #     (707.9674056178146, 476.5053775051657),
    #     (716.0224442435194, 472.97838322063296),
    #     (702.4271782136551, 462.5749158804489),
    #     (712.1969353597169, 459.48477600760043),
    #     (707.7258626406415, 452.22130766987505),
    #     (709.266493442643, 446.70341909620277),
    #     (708.9945903523661, 440.74650321379033),
    #     (718.0163228411695, 436.9202353960459),
    #     (707.8592364266663, 428.86654490397933),
    #     (703.4841149452614, 422.2861400346982),
    #     (712.6342038011794, 418.24263252865325),
    #     (715.9877079384081, 413.0164516455379),
    #     (702.2607742863556, 405.2802058701686),
    #     (711.3754860108454, 400.89436426273426),
    #     (704.7312012214618, 394.5002830462951),
    #     (698.9710968057678, 388.4203139382294),
    #     (695.5251209361539, 382.72120652751096),
    #     (695.3789890020336, 377.35191616594363),
    #     (696.1969191651654, 372.0432794504369),
    #     (698.5558859013408, 366.7652524050521),
    #     (692.433489914275, 361.28511959249573),
    #     (694.925, 356.0000000000008),
    #     (686.55, 356.0),
    #     (696.9079378446304, 350.64459016253466),
    #     (685.5872882805955, 345.64230219398735),
    #     (687.5565217467445, 340.36419134820227),
    #     (681.0822561172986, 335.5475580263144),
    #     (687.8987033330959, 329.8790055548077),
    #     (687.1487984761042, 324.6972222824288),
    #     (678.6645751646461, 320.3774992620685),
    #     (676.7506829349688, 315.4797655886607),
    #     (680.4307526337075, 309.82666629405537),
    #     (677.1962483615347, 305.1275119689176),
    #     (670.4468969086016, 301.1202311908129),
    #     (709.647967443584, 288.53804221627684),
    #     (714.3710681173012, 281.7849195819003),
    #     (718.4066895459453, 274.99250730739595),
    #     (719.0100005324623, 268.8490095384942),
    #     (705.0289421127054, 266.3845991601438),
    #     (705.5556084491116, 260.3724066925473),
    #     (707.7075623791771, 253.81950741313327),
    #     (717.7915509265385, 244.69838589144192),
    #     (705.9174687578839, 242.30492234460093),
    #     (711.1840958378278, 234.3933032729609),
    #     (714.1697867216524, 227.0509422106228),
    #     (707.2826196773906, 223.2613592897927),
    #     (713.8012361819481, 214.33646901311812),
    #     (711.0007103674566, 208.9538911137164),
    #     (717.1823329379295, 199.70244764068264),
    #     (702.60666610447, 199.50108942247246),
    #     (714.4924781870291, 187.30624468192187),
    #     (593.8650541295921, 239.471112384415),
    #     (593.4086883699905, 235.0342313443977),
    #     (591.8549525299179, 231.12123081921055),
    #     (707.5304246995922, 162.7445136340988),
    #     (703.2788794723924, 157.91562436072138),
    #     (717.5116513416624, 142.2026053848403),
    #     (714.0236050122794, 136.6028526757753),
    #     (714.7971519420871, 128.3004034736716),
    #     (717.1523608472385, 118.7672403430013),
    #     (704.2422757983009, 119.3347937553626),
    #     (710.8928936760428, 106.57709679492424),
    #     (702.3604007167675, 104.35443886228975),
    #     (711.5597912798189, 89.0381573144814),
    #     (702.9965736847755, 86.84186738830192),
    #     (607.6692956064305, 154.37487439814106),
    #     (606.6094322128268, 148.67784733423727),
    #     (598.6645537721128, 148.74489157662757),
    #     (588.309398264549, 151.19171530926872),
    #     (590.0932415607285, 142.99153947415783),
    #     (580.1214045007122, 145.53599228222518),
    #     (579.7322480681254, 139.18836822166048),
    #     (568.2381003731437, 143.76189962685595),
    #     (565.6611277933508, 139.64649964139363),
    #     (567.5592830872605, 130.7122456954133),
    #     (560.5116775427839, 131.2446010133731),
    #     (552.1781648482602, 133.47955119412526),
    #     (549.844006225351, 129.0378294175311),
    #     (550.5896084705311, 120.78156981162087),
    #     (538.6959041812947, 127.95823497573767),
    #     (535.4591853095914, 124.64261237639758),
    #     (537.4169710822144, 114.37528043812702),
    #     (529.5142064767373, 117.17818326051622),
    #     (524.2177864852621, 116.65030016730768),
    #     (523.1776486576688, 110.00556019638984),
    #     (519.4440929180446, 107.18014852066418),
    #     (512.6087765024878, 109.22405557389564),
    #     (506.44039924583865, 110.50358067834912),
    #     (503.08751708106706, 107.28859129721471),
    #     (497.577314504561, 107.78854474928553),
    #     (494.8654965598172, 103.40459947736008),
    #     (493.87551977187866, 95.5984570943649),
    #     (488.58792544893186, 95.78154461079237),
    #     (480.94272423907967, 100.96016848398543),
    #     (523.831552252662, -0.6602034057922879),
    #     (518.9596860076239, -4.915697547638274),
    #     (511.1061086874124, -2.4290690608760883),
    #     (506.346753490434, -6.96917133537022),
    #     (496.46712619065477, 1.2205373971937092),
    #     (492.7505801871008, -5.899909427306568),
    #     (484.915183997353, -2.075698644757267),
    #     (479.80123723533245, -5.59382414388665),
    #     (473.2487730907133, -4.8546186952845005),
    #     (463.5011429049295, 6.562073789733915),
    #     (456.80646138962544, 9.021884022776248),
    #     (451.8320949211736, 5.6968595515928655),
    #     (446.95832623054565, 1.7407088172044496),
    #     (440.5889275931875, 3.661759343902702),
    #     (435.6004687855984, -0.11202643144719104),
    #     (430.5800975497419, -4.133669176420312),
    #     (422.6983789267889, 6.354853103124412),
    #     (417.3142153871445, 4.685386560056315),
    #     (411.9174995286305, 2.9508026542712855),
    #     (406.09391048460964, 4.021839090320668),
    #     (400.2394981173613, 5.808313303518901),
    #     (394.8925832084444, 3.715388362797057),
    #     (389.49079600222706, 1.7043858468777557),
    #     (383.63721647013404, 4.835869192506209),
    #     (378.20115794257765, 3.122699495974132),
    #     (372.4436842814692, 7.312516897651449),
    #     (366.89403651727264, 9.34613720115459),
    #     (359.73323664208755, 118.35432137491952),
    #     (356.00000000000057, 123.9),
    #     (356.00000000000006, 118.875),
    #     (352.32841457836196, 122.27883715741004),
    #     (344.6591454348419, -4.8718436200480255),
    #     (339.05463201847385, -3.325660270693618),
    #     (333.87262091787, 4.295380901877309),
    #     (328.3549376202939, 4.736177459132875),
    #     (321.9233797473661, -4.492987382774743),
    #     (317.40095607372507, 6.374233918641664),
    #     (311.2842355950952, 2.0382774385261655),
    #     (304.9479611382153, -2.71032178215205),
    #     (301.0719484627495, 9.197931408535453),
    #     (294.0840327618781, 1.2375039185142782),
    #     (287.66203457058657, -2.240160340751686),
    #     (282.8596922472899, 2.8188127789940722),
    #     (275.6578441936538, -3.4301434220390092),
    #     (269.14081624331425, -5.794538131964828),
    #     (264.0593487151535, -2.085194669254065),
    #     (260.45156860753957, 6.733758776434854),
    #     (251.63640200837463, -3.221860469604792),
    #     (247.17567563152528, 2.261005223141126),
    #     (240.53580005180214, 0.6377326863195663),
    #     (236.3611015885142, 6.563372717047798),
    #     (225.78067500970303, -5.6980896052303365),
    #     (218.9312924534983, -6.741809055052499),
    #     (216.802903516107, 4.428266273507006),
    #     (210.76207033163948, 5.3646204236541735),
    #     (200.70524606453543, -2.865002508077282),
    #     (197.76244125737034, 5.542655051755105),
    #     (188.5090711805892, 0.06365823617881006),
    #     (183.26888343532164, 3.4119230669888907),
    #     (171.43016233088701, -6.23870240878108),
    #     (169.98620058606477, 4.6810678989907615),
    #     (157.48135474453693, -5.104075179072709),
    #     (157.94039729414501, 8.76455210333296),
    #     (142.73709887138372, -4.607872213298833),
    #     (137.38660052284683, -0.7446447657521844),
    #     (129.85430117911383, -0.3486009581263261),
    #     (118.71233806120767, -5.235941583366014),
    #     (109.35781379848504, -6.9229559916778385),
    #     (111.03338749826224, 7.447766634004722),
    #     (98.68231117766402, 1.8325852875096302),
    #     (91.69501681154759, 3.978813333985272),
    #     (82.03054701711926, 2.8007094680664864),
    #     (75.35983370371753, 5.703811666189495),
    #     (69.35043181001288, 9.500194723726167),
    #     (55.50038803762402, 4.1601597168659055),
    #     (38.42150947494969, -4.2220884132867695),
    #     (28.798141244384055, -3.5901476012272724),
    #     (22.557104702136485, 0.9193815830315657),
    #     (10.653274691062336, -0.3701752649839136),
    #     (1.916279320833894, 1.9162793208344056),
    #     (-1.0523952478593515, 9.992157534299963),
    #     (3.160960112352143, 24.662087052867662),
    #     (3.8431449033074614, 35.56191700515768),
    #     (9.617460821395014, 50.62271339017133),
    #     (3.3997537512656777, 54.850939989294034),
    #     (-2.577600356784444, 59.358810770702405),
    #     (0.02618045280280512, 70.81119337887577),
    #     (-1.3476043469063939, 78.81278498544157),
    #     (-1.159160596794095, 87.83731686382953),
    #     (-6.035104982787061, 92.96609959912007),
    #     (5.750105970347477, 109.84025160027281),
    #     (9.432562364601495, 120.47301259551111),
    #     (9.996647577570513, 128.7182789192238),
    #     (-1.0662796948033701, 129.3988484033822),
    #     (-5.62600970668035, 134.39529623984774),
    #     (2.428693857457233, 146.89851244514307),
    #     (-1.8761839485349014, 151.87102860584807),
    #     (4.44766763340516, 162.73246979224598),
    #     (121.36022521145026, 231.76463431381688),
    #     (122.53401549954734, 237.04313930574773),
    #     (117.25936898404069, 239.04217169380507),
    #     (-1.9948233081814806, 187.54042329227886),
    #     (2.967940795260006, 196.59991319431083),
    #     (-4.218690580961265, 200.11945292584932),
    #     (6.35779092110397, 211.1734550214317),
    #     (7.728972798410325, 218.10974567813764),
    #     (-3.3274383425234078, 220.2214756332923),
    #     (0.5587675083153272, 228.03328217933426),
    #     (-4.978868660648686, 232.40930908649614),
    #     (2.7776098479836833, 241.23108828914567),
    #     (-3.4259632149087906, 245.42613569639263),
    #     (3.788283435836945, 253.6730370824609),
    #     (-5.37143682521031, 257.13996183047357),
    #     (-2.714773723987321, 263.89770028849614),
    #     (0.3313923665363063, 270.61152203560476),
    #     (-2.405430822003268, 275.88689459711986),
    #     (-1.391845306679329, 281.98770687725613),
    #     (6.281181559319748, 289.2875674746173),
    #     (1.6315476489764933, 294.15280440198916),
    #     (4.778026084372243, 300.37190423169403),
    #     (0.5567562883126698, 305.41293520360864),
    #     (4.940212939868729, 311.65083530327007),
    #     (-3.59022465979848, 316.3008696050362),
    #     (-0.2369599840982346, 322.325692786802),
    #     (8.225388127198869, 328.62954445534046),
    #     (4.869246270723579, 333.90872546659875),
    #     (4.815292210246525, 339.43854959175655),
    #     (4.773394687481357, 344.9622592599451),
    #     (-0.6559948062098897, 350.39719991487254),
    #     (-5.550000000000011, 355.9999999999993),
    #     (5.5, 356.0),
    #     (-4.455526009640209, 361.6624878909114),
    #     (-5.196683252166906, 367.35106306185867),
    #     (-5.348412267491597, 373.0407585442132),
    #     (1.4011033894352636, 378.30947158876506),
    #     (6.829703859972426, 383.48029827867765),
    #     (3.2475068920142576, 389.34492811658254),
    #     (1.9014096190933856, 395.09284832618476),
    #     (4.716987132075246, 400.3773646742811),
    #     (0.309250373883458, 406.6222901043751),
    #     (1.4939623518933445, 412.1482403645644),
    #     (5.645868153056881, 417.1465845143716),
    #     (6.600424915806514, 422.65153359814207),
    #     (0.4686780335019307, 429.62699726156586),
    #     (-6.431087465000644, 437.0129462736406),
    #     (9.447360370268825, 439.19992767824453),
    #     (-4.555081730132031, 448.57481049711697),
    #     (-6.601247533744129, 455.19647630823187),
    #     (-6.678917738041889, 461.3679659733666),
    #     (0.5166829711344008, 465.36094796202366),
    #     (-4.3553140242295285, 473.08653916866626),
    #     (7.533110209845518, 475.30688305783303),
    #     (4.557510776370009, 482.52708165962355),
    #     (-1.4331641800939678, 491.06273780805486),
    #     (4.939643340746727, 494.99462797991606),
    #     (1.9693631416765243, 502.6442912823018),
    #     (8.859312835036917, 506.22118963260465),
    #     (-2.887825257124234, 518.0440665597276),
    #     (1.8959330174242268, 522.6287257539908),
    #     (118.47170621131752, 472.3639104268895),
    #     (124.31602854791913, 474.048879694776),
    #     (122.84053264184885, 479.45158324729675),
    #     (-0.9854337828642201, 552.2544029871838),
    #     (-6.175909945006367, 562.5814918028939),
    #     (-2.8433510579407084, 568.219366226328),
    #     (-0.9364888027320148, 574.7309616542144),
    #     (-2.670502753259825, 583.6192225070804),
    #     (-1.0360095924898474, 590.5288222783515),
    #     (1.1617566218594675, 597.1478211830083),
    #     (-4.374496782790175, 609.2754383937654),
    #     (5.958571958817572, 610.3199840356475),
    #     (0.940011631729817, 622.5865800446943),
    #     (9.1417034423813, 625.0508738773157),
    #     (-2.1980462081094743, 642.9707481916803),
    #     (-1.3062535061989138, 651.5894396462082),
    #     (2.031023013183983, 658.3180664977021),
    #     (6.654522096352821, 663.9894684778594),
    #     (8.16998680893272, 672.5009597908105),
    #     (-2.7619099854464935, 692.8998581828034),
    #     (3.5256599003805604, 697.5713983874255),
    #     (-6.356870019048472, 718.356870019049),
    #     (7.069323788608415, 716.0685256984686),
    #     (21.547397720892207, 712.1558471424153),
    #     (31.809872242347353, 712.2802984511911),
    #     (47.894801945718655, 705.4767473408225),
    #     (59.315895321559594, 703.3724552352396),
    #     (57.46247440120021, 716.8698772540426),
    #     (65.88740746022842, 718.1197090049911),
    #     (74.55308096256027, 718.8391816829085),
    #     (89.20327287644682, 711.3398779987349),
    #     (104.29566033706092, 702.4413024162054),
    #     (102.3795584550088, 716.8653866132458),
    #     (115.75151222155566, 709.5149144593015),
    #     (128.19670724211963, 702.7973694157388),
    #     (131.28763785567998, 710.0900237574136),
    #     (133.54623607218738, 719.0115499737512),
    #     (149.66006212558366, 704.9017806460549),
    #     (153.55558807851648, 710.9228367994488),
    #     (165.34598347424838, 702.7983686273556),
    #     (171.65904967205117, 704.1594699734336),
    #     (175.6863232659487, 709.8855162445092),
    #     (183.91779371086164, 707.2634862587593),
    #     (192.70299720250932, 703.0237952970224),
    #     (195.91062664364304, 710.5586596931144),
    #     (203.942001373209, 707.3853023087529),
    #     (206.38991211687036, 717.1907032352822),
    #     (212.62468984313432, 718.1246968413284),
    #     (220.000553855929, 715.9120908617961),
    #     (228.1518404514199, 711.111924222551),
    #     (235.0411381093569, 709.2919251201732),
    #     (241.16155946541343, 709.4363778681759),
    #     (246.43322381031234, 712.1523721392284),
    #     (251.5457298989133, 715.5339559174441),
    #     (257.9909524166096, 714.2607391506931),
    #     (266.4902923621886, 704.6172942692256),
    #     (270.010400223677, 714.1724601784838),
    #     (275.6360298695153, 715.5277350982258),
    #     (281.8102679938194, 714.2486652659734),
    #     (288.96433470695894, 707.4132639481761),
    #     (294.74166157044635, 706.9944529089435),
    #     (299.7383446482812, 711.2221116950366),
    #     (305.402367611215, 711.5174954860054),
    #     (311.7918351910303, 705.9436580211486),
    #     (316.5313116583264, 713.5029066533539),
    #     (322.37039423562766, 711.7640680509176),
    #     (327.7390337188301, 715.0896236106664),
    #     (333.5853542910227, 712.270591380682),
    #     (339.45503684950546, 706.8350963335099),
    #     (344.7565187879834, 713.7733732829088),
    #     (352.3036755535952, 591.2959685387523),
    #     (355.9999999999995, 592.725),
    # ]

    point_list = [
        (83.1, -3.632416e-06),
        (83.1, -3.632416e-06),
        (83.30001, -3.641159e-06),
        (83.3, -0.02588349),
        (82.99994, -0.05149453),
        (83.01518, -0.1359079),
        (83.23918, -0.24307),
        (83.25309, -0.4739056),
        (83.34502, -0.7704242),
        (83.21826, -1.376073),
        (83.22192, -2.021496),
        (83.22225, -2.869568),
        (82.41246, -3.473631),
        (82.38685, -4.007698),
        (78.85378, -4.528697),
        (78.81827, -5.093258),
        (77.57478, -5.681277),
        (77.53903, -6.145475),
        (77.08861, -6.764423),
        (76.44882, -7.185619),
        (76.38289, -7.833317),
        (75.83332, -8.270997),
        (74.86782, -8.800244),
        (74.81258, -9.274181),
        (74.55036, -9.7468),
        (73.95532, -10.37088),
        (73.8637, -10.95323),
        (73.49545, -11.34936),
        (73.4317, -11.75855),
        (72.74934, -12.20518),
        (72.6756, -12.62242),
        (72.57981, -13.15695),
        (72.50167, -13.57294),
        (72.08944, -14.1347),
        (71.99094, -14.60546),
        (69.70286, -14.75953),
        (69.59889, -15.22216),
        (69.17648, -15.74772),
        (69.07761, -16.17685),
        (68.09808, -16.3938),
        (67.95325, -16.95109),
        (67.36038, -17.22733),
        (67.21752, -17.77879),
        (67.1044, -18.21788),
        (66.57604, -18.64492),
        (65.59843, -18.79363),
        (65.4294, -19.36723),
        (65.49162, -19.85499),
        (65.31444, -20.43473),
        (64.27621, -20.73608),
        (64.2367, -21.2027),
        (64.05138, -21.78089),
        (62.96231, -21.87807),
        (62.78487, -22.36305),
        (62.08955, -22.51145),
        (61.52683, -22.88481),
        (61.39022, -23.25303),
        (60.75039, -23.53059),
        (60.33847, -23.7467),
        (60.21072, -24.06789),
        (59.47723, -24.29621),
        (59.3292, -24.65457),
        (58.94283, -25.04636),
        (58.78271, -25.42068),
        (58.27809, -25.84507),
        (57.74838, -26.06159),
        (57.52607, -26.55667),
        (56.98907, -26.75715),
        (56.58269, -27.13703),
        (56.41052, -27.50497),
        (55.77237, -27.66879),
        (55.53017, -28.14338),
        (55.08808, -28.34773),
        (54.84636, -28.8333),
        (54.60933, -29.29049),
        (54.02011, -29.52714),
        (53.83846, -29.84296),
        (53.74766, -30.19547),
        (53.34064, -30.52199),
        (53.15252, -30.84792),
        (52.90651, -31.24898),
        (52.71909, -31.54604),
        (52.19341, -31.82657),
        (51.90778, -32.10796),
        (51.63093, -32.54364),
        (51.16094, -32.70033),
        (50.8798, -33.1049),
        (50.41493, -33.26607),
        (50.19764, -33.59446),
        (49.56524, -33.80949),
        (49.18989, -33.98927),
        (48.90481, -34.40445),
        (48.53298, -34.60062),
        (48.08351, -34.90283),
        (47.86937, -35.19706),
        (47.24954, -35.3559),
        (47.02186, -35.66711),
        (46.70162, -36.10028),
        (46.44983, -36.43095),
        (45.6489, -36.46997),
        (45.41965, -36.75611),
        (45.0899, -37.16129),
        (45.08502, -37.63691),
        (44.24308, -37.53711),
        (44.00473, -37.81102),
        (43.77061, -38.23647),
        (43.53302, -38.50836),
        (43.27892, -38.92839),
        (42.97402, -39.10897),
        (42.67015, -39.43795),
        (42.71252, -39.98008),
        (42.3841, -40.32633),
        (41.98884, -40.44733),
        (41.6448, -40.65446),
        (41.30231, -41.00702),
        (41.45909, -41.69947),
        (40.95495, -41.90975),
        (40.69409, -42.15333),
        (40.13572, -42.27223),
        (39.85764, -42.53992),
        (39.50912, -42.87201),
        (39.25648, -43.1096),
        (39.05145, -43.43126),
        (38.52011, -43.64887),
        (38.16219, -43.96775),
        (38.33253, -44.74599),
        (37.59678, -44.58425),
        (37.34151, -44.80669),
        (37.11706, -45.26532),
        (36.86085, -45.47596),
        (36.70323, -45.98293),
        (36.11567, -45.81257),
        (35.85127, -46.02496),
        (35.55012, -46.39217),
        (35.25741, -46.60995),
        (34.85463, -46.89675),
        (34.5669, -47.10368),
        (34.27315, -47.56521),
        (33.91292, -47.6997),
        (33.49626, -47.9827),
        (33.19529, -48.18486),
        (33.32857, -49.06177),
        (32.92519, -49.33546),
        (32.46017, -49.52053),
        (32.13676, -49.72732),
        (31.82843, -49.92253),
        (31.39248, -50.20418),
        (31.15173, -50.59123),
        (30.84436, -51.23721),
        (30.40938, -51.49332),
        (30.42095, -52.30225),
        (30.14431, -52.58397),
        (29.69509, -52.84121),
        (29.71373, -53.63453),
        (29.31076, -53.85953),
        (28.86311, -53.7679),
        (28.57413, -54.26524),
        (28.25406, -54.42941),
        (27.87931, -54.72555),
        (27.52865, -54.89675),
        (27.30122, -55.57058),
        (26.9086, -55.65088),
        (26.51793, -55.83144),
        (26.08371, -56.1396),
        (25.72518, -56.30426),
        (25.41254, -56.99591),
        (25.04225, -57.15913),
        (24.55256, -57.36441),
        (24.28204, -57.80187),
        (23.79897, -58.00157),
        (23.54431, -58.42659),
        (23.39865, -59.12669),
        (22.83204, -59.33816),
        (22.47611, -59.90265),
        (22.13938, -60.24316),
        (21.6053, -60.43489),
        (21.24616, -60.66693),
        (20.70022, -60.85538),
        (20.33784, -61.0849),
        (19.90794, -61.54316),
        (19.5343, -61.65712),
        (19.29082, -62.2512),
        (18.80454, -62.39935),
        (18.47512, -62.60554),
        (17.91715, -62.56081),
        (17.57176, -62.65596),
        (17.29225, -63.45937),
        (16.91642, -63.565),
        (16.50895, -64.09167),
        (16.0846, -64.09719),
        (15.66578, -64.1978),
        (15.25636, -64.80889),
        (14.71808, -64.93243),
        (14.27958, -65.027),
        (13.8561, -65.11095),
        (13.47852, -66.00006),
        (13.00642, -65.88956),
        (12.4129, -66.00467),
        (12.03273, -66.97992),
        (11.68944, -67.43742),
        (11.30888, -67.50207),
        (10.92142, -68.38397),
        (10.48952, -68.45456),
        (10.12858, -69.82304),
        (9.737741, -69.87916),
        (9.363224, -71.14651),
        (9.082436, -72.09507),
        (8.535654, -72.1646),
        (8.178061, -73.01291),
        (7.690806, -73.87353),
        (7.256666, -73.91944),
        (6.841016, -74.46468),
        (6.231974, -74.51675),
        (5.818027, -75.25011),
        (5.211135, -75.79581),
        (4.725683, -75.83235),
        (4.126645, -76.77454),
        (3.627413, -76.8024),
        (3.008248, -77.73448),
        (2.548339, -77.95561),
        (2.078583, -77.97305),
        (1.424461, -78.38454),
        (0.7713015, -78.58602),
        (0.09252591, -78.58599),
        (-0.4037362, -79.58229),
        (-1.089183, -79.56753),
        (-1.624214, -80.3535),
        (-2.157186, -80.33839),
        (-2.825701, -80.41412),
        (-3.330642, -80.79114),
        (-4.010034, -80.75054),
        (-4.491317, -80.81944),
        (-5.106672, -80.77668),
        (-5.603889, -80.84068),
        (-6.255551, -81.19157),
        (-6.733311, -81.1475),
        (-104.6087, -31.6977),
        (-104.8033, -31.05577),
        (-101.9389, -28.35509),
        (-102.1631, -27.51475),
        (-100.2977, -26.36356),
        (-100.5082, -25.56873),
        (-99.79102, -24.73099),
        (-99.99187, -23.88946),
        (-99.64656, -23.16522),
        (-97.1083, -21.72226),
        (-97.2384, -21.13403),
        (-96.51431, -20.16804),
        (-94.37502, -19.12703),
        (-94.53345, -18.34137),
        (-94.55131, -17.74757),
        (-94.69925, -16.9572),
        (-93.13096, -16.06543),
        (-92.06796, -15.16767),
        (-92.15516, -14.65468),
        (-90.8879, -13.74304),
        (-90.96938, -13.21862),
        (-90.67465, -12.44642),
        (-88.77059, -11.62086),
        (-88.84627, -11.10584),
        (-88.54603, -10.38755),
        (-88.61579, -9.825004),
        (-87.09956, -8.932307),
        (-86.65675, -8.335585),
        (-86.72961, -7.580383),
        (-85.77773, -6.963749),
        (-85.82807, -6.233823),
        (-84.76737, -5.582425),
        (-83.71933, -4.749499),
        (-83.75799, -4.053957),
        (-82.78327, -3.436464),
        (-82.7986, -2.889577),
        (-81.71877, -2.158614),
        (-80.33457, -1.595983),
        (-80.35052, -0.9112369),
        (-79.05626, -0.3715281),
        (-78.0572, 0.3398008),
        (-78.05373, 0.8329256),
        (-77.34355, 1.486995),
        (-77.32791, 2.041044),
        (-76.80869, 2.527144),
        (-76.78318, 3.151783),
        (-75.86804, 3.556182),
        (-75.14001, 4.148087),
        (-75.11333, 4.597421),
        (-74.47803, 5.147663),
        (-74.15521, 5.530622),
        (-74.12771, 6.047451),
        (-73.6099, 6.391967),
        (-73.56548, 6.972437),
        (-72.92715, 7.346261),
        (-72.86644, 7.923871),
        (-72.50263, 8.464019),
        (-71.52828, 8.986263),
        (-71.46731, 9.450106),
        (-70.61161, 9.820722),
        (-70.13084, 10.35843),
        (-70.06553, 10.80781),
        (-69.3736, 11.34593),
        (-68.71358, 11.66523),
        (-68.61886, 12.19571),
        (-67.95236, 12.4947),
        (-67.85137, 13.01222),
        (-67.37949, 13.32413),
        (-67.27122, 13.86231),
        (-66.60058, 14.11994),
        (-66.48464, 14.63109),
        (-65.89762, 14.94229),
        (-65.60699, 15.2984),
        (-65.4765, 15.83752),
        (-64.88355, 16.13697),
        (-64.5461, 16.63014),
        (-64.43887, 17.05477),
        (-63.42453, 17.38033),
        (-63.31839, 17.7613),
        (-62.69504, 18.12861),
        (-62.57473, 18.54999),
        (-62.31634, 19.08852),
        (-61.78457, 19.46432),
        (-61.66005, 19.8441),
        (-61.15829, 20.08789),
        (-60.89968, 20.5654),
        (-60.77861, 20.94121),
        (-60.04894, 21.212),
        (-59.91841, 21.5699),
        (-59.16914, 21.87431),
        (-58.75073, 22.14697),
        (-58.56732, 22.63109),
        (-58.43323, 22.96257),
        (-58.2972, 23.30341),
        (-57.46257, 23.50001),
        (-57.13377, 23.7778),
        (-56.94363, 24.2358),
        (-56.98228, 24.64161),
        (-56.13037, 24.82895),
        (-55.95603, 25.21904),
        (-55.74207, 25.70202),
        (-55.58432, 26.04277),
        (-55.44917, 26.5585),
        (-55.28502, 26.91582),
        (-54.78911, 27.26238),
        (-54.43462, 27.53264),
        (-54.19498, 27.98496),
        (-53.8787, 28.36679),
        (-53.5213, 28.6265),
        (-53.34936, 28.96435),
        (-52.5857, 29.10789),
        (-52.39223, 29.45407),
        (-52.31761, 30.00021),
        (-51.69954, 30.08123),
        (-51.44609, 30.5132),
        (-51.1775, 30.75648),
        (-50.93166, 31.16514),
        (-50.57094, 31.39157),
        (-50.06868, 31.64033),
        (-49.87043, 31.94183),
        (-49.65975, 32.25594),
        (-49.39503, 32.66577),
        (-49.10903, 32.92981),
        (-49.08485, 33.51623),
        (-48.88144, 33.8089),
        (-48.26388, 33.98351),
        (-48.03588, 34.31109),
        (-47.66751, 34.65757),
        (-47.46195, 34.93111),
        (-47.16693, 35.31052),
        (-46.87485, 35.52704),
        (-46.5672, 35.94225),
        (-46.50061, 36.36622),
        (-46.20252, 36.73537),
        (-45.81973, 36.87727),
        (-45.49706, 37.27881),
        (-45.34563, 37.63384),
        (-44.72697, 37.76508),
        (-44.47958, 38.04939),
        (-44.42754, 38.71266),
        (-44.18102, 39.00429),
        (-43.94056, 39.27875),
        (-43.38734, 39.43786),
        (-43.15571, 39.67968),
        (-42.69742, 39.88097),
        (-42.45723, 40.14413),
        (-42.2973, 40.60859),
        (-42.05372, 40.85781),
        (-41.7023, 41.20255),
        (-41.65681, 41.67896),
        (-41.09927, 41.81955),
        (-40.82366, 42.08915),
        (-40.74876, 42.70696),
        (-40.47336, 42.97478),
        (-40.18852, 43.25675),
        (-39.54771, 43.31554),
        (-39.20659, 43.61929),
        (-39.2628, 44.23877),
        (-38.90006, 44.56594),
        (-38.7632, 44.9621),
        (-38.40008, 45.27241),
        (-38.12269, 45.49941),
        (-37.86518, 45.97187),
        (-37.44698, 46.05927),
        (-37.18585, 46.27238),
        (-37.02664, 46.77463),
        (-36.72476, 47.00994),
        (-36.50852, 47.5596),
        (-36.21828, 47.79333),
        (-35.7557, 48.02355),
        (-35.45364, 48.24016),
        (-35.26987, 48.86621),
        (-34.87656, 49.02843),
        (-34.5628, 49.25356),
        (-34.11098, 49.44448),
        (-34.20244, 50.22654),
        (-33.77737, 50.51191),
        (-33.53674, 50.79292),
        (-33.14291, 51.05581),
        (-33.07976, 51.56983),
        (-32.64162, 51.84778),
        (-32.32157, 52.0552),
        (-31.71523, 52.08724),
        (-31.38337, 52.28997),
        (-31.2225, 53.08311),
        (-30.96992, 53.46916),
        (-30.51635, 53.74383),
        (-30.22282, 54.02882),
        (-29.99027, 54.73),
        (-29.62543, 54.92724),
        (-29.29018, 55.45141),
        (-28.93302, 55.64512),
        (-28.73855, 56.31515),
        (-28.3932, 56.48932),
        (-28.02232, 56.67133),
        (-27.68145, 57.16646),
        (-27.31824, 57.33634),
        (-27.11021, 58.20057),
        (-26.90778, 58.73372),
        (-26.42079, 58.95566),
        (-26.2368, 59.58515),
        (-25.75934, 59.79056),
        (-25.44189, 60.03093),
        (-25.05938, 60.18793),
        (-24.73515, 60.75489),
        (-24.32861, 61.13718),
        (-23.96847, 61.28105),
        (-23.64137, 61.83385),
        (-23.33757, 62.48077),
        (-22.95076, 62.62551),
        (-22.77402, 63.33317),
        (-22.25067, 63.52495),
        (-21.87778, 63.87035),
        (-21.43109, 64.34052),
        (-21.032, 64.4733),
        (-20.75412, 65.50992),
        (-20.34026, 65.64023),
        (-19.92375, 66.2959),
        (-19.49914, 66.42353),
        (-19.26696, 67.11559),
        (-18.88493, 67.74301),
        (-18.48603, 67.85378),
        (-18.01714, 68.28925),
        (-17.75366, 68.87309),
        (-17.20957, 69.01166),
        (-16.846, 69.2031),
        (-16.31667, 69.32174),
        (-16.07022, 70.08836),
        (-15.51475, 70.20819),
        (-15.22072, 71.19502),
        (-14.78517, 71.70055),
        (-14.3156, 71.79903),
        (-13.88636, 72.69851),
        (-13.52788, 73.27722),
        (-13.04469, 73.36409),
        (-12.58005, 74.35822),
        (-12.1129, 74.43214),
        (-11.55601, 75.02715),
        (-11.32171, 76.58404),
        (-10.70052, 76.67463),
        (-10.26671, 77.54034),
        (-9.554298, 77.63356),
        (-9.066753, 78.60274),
        (-8.600256, 79.26313),
        (-7.904748, 79.34338),
        (-7.484003, 80.49269),
        (-7.060093, 81.8401),
        (-6.389767, 81.899),
        (-5.974133, 83.03356),
        (-5.294234, 83.07674),
        (-4.794074, 82.89916),
        (-4.150545, 82.93102),
        (-3.710158, 84.45592),
        (-3.058154, 85.08948),
        (-2.425009, 85.11121),
        (-1.718949, 85.12516),
        (-1.222027, 86.43414),
        (-0.5183876, 86.43699),
        (0.03628503, 87.93401),
        (0.8150864, 87.92594),
        (1.389018, 89.11873),
        (1.991061, 90.50952),
        (2.820117, 90.49005),
        (3.449121, 91.76968),
        (4.219421, 91.73778),
        (4.888934, 93.50885),
        (5.718826, 94.86572),
        (6.306837, 94.82821),
        (7.226797, 95.76546),
        (7.810361, 95.72009),
        (8.60224, 96.45522),
        (9.285654, 97.49274),
        (10.0632, 97.40921),
        (10.84676, 99.33068),
        (11.45606, 99.25746),
        (12.36402, 99.95891),
        (12.96383, 99.88754),
        (13.95439, 101.0625),
        (14.99681, 104.1415),
        (15.97123, 104.2058),
        (16.63609, 104.1067),
        (17.79231, 105.8394),
        (18.4364, 105.7247),
        (19.59166, 107.0424),
        (20.22809, 106.9264),
        (21.04774, 69.07056),
        (21.61525, 68.89242),
        (22.2573, 69.42463),
        (22.7882, 69.26267),
        (23.06252, 68.75322),
        (23.39313, 68.32356),
        (23.99813, 68.10987),
        (24.4875, 68.14902),
        (25.05508, 67.94794),
        (25.27758, 67.32561),
        (25.99259, 67.58049),
        (26.39682, 67.41852),
        (26.90836, 67.10715),
        (27.29673, 66.94786),
        (27.86237, 66.81431),
        (28.22157, 66.43935),
        (28.75424, 66.20508),
        (29.15724, 66.03467),
        (29.59704, 65.8463),
        (30.27985, 65.86627),
        (30.99341, 65.86578),
        (31.42276, 65.67218),
        (32.09513, 65.68803),
        (32.51423, 65.47625),
        (33.14931, 65.25566),
        (33.48389, 64.85752),
        (34.04523, 64.56604),
        (34.57616, 64.50803),
        (35.121, 64.20138),
        (94.88295, 120.6426),
        (95.6041, 120.0787),
        (96.58557, 119.3024),
        (97.34167, 118.6878),
        (98.64455, 118.2545),
        (98.93942, 117.0914),
        (100.0026, 116.1837),
        (101.0698, 115.9251),
        (102.041, 115.0712),
        (102.4943, 113.9915),
        (103.1479, 113.2601),
        (104.039, 112.439),
        (104.4443, 111.5096),
        (105.3066, 110.6789),
        (106.7056, 110.8516),
        (107.7433, 110.1115),
        (108.3788, 109.4843),
        (109.1792, 108.3902),
        (109.8184, 107.7292),
        (110.7074, 106.8077),
        (120.9359, 64.15016),
        (121.4547, 63.15417),
        (122.1232, 62.50156),
        (122.6788, 61.39807),
        (121.9878, 60.08685),
        (122.4794, 59.06631),
        (123.3116, 58.47549),
        (124.1197, 57.46732),
        (124.4861, 56.6836),
        (124.384, 55.70553),
        (125.6968, 54.93834),
        (126.0572, 54.08768),
        (125.5972, 52.60006),
        (125.9372, 51.77366),
        (104.065, 41.82689),
        (104.3144, 41.18595),
        (103.7813, 39.51084),
        (104.0048, 38.91932),
        (103.751, 37.86041),
        (103.9771, 37.22513),
        (96.14748, 32.6392),
        (96.34249, 32.05395),
        (95.93181, 31.03703),
        (96.19414, 30.18585),
        (95.70258, 29.40102),
        (95.35409, 28.48198),
        (95.52431, 27.88948),
        (95.44614, 27.05084),
        (95.12939, 26.3377),
        (95.34816, 25.55222),
        (94.04652, 24.6016),
        (94.2373, 23.85695),
        (89.91214, 22.18203),
        (90.03887, 21.67917),
        (89.2299, 20.77563),
        (88.18854, 19.96273),
        (88.34532, 19.25462),
        (87.87371, 18.59772),
        (87.34176, 17.74477),
        (87.44192, 17.24695),
        (86.29171, 16.31147),
        (86.38876, 15.74955),
        (85.62078, 14.91065),
        (85.74004, 14.19579),
        (84.93611, 13.5294),
        (84.42854, 12.86285),
        (84.53115, 12.14713),
        (84.01371, 11.54046),
        (83.51609, 10.74781),
        (83.59719, 10.06356),
        (82.97703, 9.289708),
        (83.03527, 8.725485),
        (82.49214, 8.126037),
        (79.86613, 7.231761),
        (79.91109, 6.713331),
        (78.56704, 5.930693),
        (78.60381, 5.426539),
        (77.84744, 4.722775),
        (77.87679, 4.265838),
        (77.60931, 3.623427),
        (76.73007, 3.093501),
        (76.74643, 2.623287),
        (76.75928, 2.01352),
        (75.96686, 1.528739),
        (75.97548, 0.917093),
        (75.48172, 0.4423734),
        (75.48283, -0.2027617),
        (75.0789, -0.6388898),
        (75.06673, -1.238211),
        (74.35428, -1.717077),
        (73.83646, -2.30806),
        (73.82041, -2.751371),
        (73.49982, -3.213663),
        (73.16879, -3.807827),
        (73.13275, -4.419136),
        (72.10328, -4.806069),
        (71.45935, -5.340794),
        (71.42391, -5.767471),
        (70.87473, -6.30551),
        (70.83875, -6.743423),
        (70.38678, -7.266076),
        (70.3348, -7.699212),
        (70.06671, -8.254954),
        (69.51758, -8.630995),
        (69.44609, -9.192174),
        (68.8915, -9.534788),
        (68.40797, -10.05115),
        (68.34323, -10.5007),
        (67.88179, -10.8886),
        (67.79038, -11.42406),
        (66.92937, -11.67642),
        (66.82322, -12.25807),
        (66.84631, -12.6976),
        (66.3483, -13.18246),
        (66.25936, -13.60839),
        (65.36469, -13.94824),
        (64.49632, -14.16292),
        (64.40681, -14.56419),
        (63.9996, -14.99324),
        (63.85873, -15.542),
        (63.1723, -15.82633),
        (63.04099, -16.36796),
        (62.93694, -16.7661),
        (62.10832, -17.13379),
        (61.99583, -17.54105),
        (61.46558, -17.94839),
        (61.3459, -18.35456),
        (60.61498, -18.69016),
        (60.40055, -19.03763),
        (60.2775, -19.43257),
        (60.03065, -19.88838),
        (59.91863, -20.23361),
        (59.75304, -20.70561),
        (59.24874, -20.93207),
        (59.08053, -21.40923),
        (58.66877, -21.65695),
        (58.49287, -22.11278),
        (58.25509, -22.42868),
        (58.23162, -23.01667),
        (58.08085, -23.39111),
        (57.51318, -23.71333),
        (56.98698, -23.90978),
        (56.83773, -24.23769),
        (56.52281, -24.71681),
        (56.31194, -25.1931),
        (56.15129, -25.52579),
        (55.57053, -25.81074),
        (55.3966, -26.18013),
        (55.41547, -26.61826),
        (55.1893, -27.09881),
        (54.65522, -27.27129),
        (54.1378, -27.6254),
        (53.95479, -27.98751),
        (53.71068, -28.46371),
        (53.51456, -28.83357),
        (53.2669, -29.29155),
        (52.72763, -29.43835),
        (52.47223, -29.89806),
        (51.85165, -29.97106),
        (51.60255, -30.38843),
        (51.39927, -30.7269),
        (51.21194, -31.04439),
        (50.79056, -31.36565),
        (50.42597, -31.57442),
        (50.18125, -31.95938),
        (49.90742, -32.20589),
        (49.64439, -32.61443),
        (49.44658, -32.90993),
        (49.23062, -33.39313),
        (48.93563, -33.64233),
        (48.66729, -34.0308),
        (48.38147, -34.26473),
        (48.09411, -34.65724),
        (48.04417, -35.05613),
        (47.75041, -35.45306),
        (47.67998, -35.89305),
        (47.31571, -36.22328),
        (47.10142, -36.50182),
        (46.94949, -36.85731),
        (46.80402, -37.3624),
        (46.56929, -37.66328),
        (46.39505, -38.19933),
        (46.15881, -38.4848),
        (45.46987, -38.53486),
        (45.2351, -38.82319),
        (45.33053, -39.49757),
        (44.73166, -39.42135),
        (44.39794, -39.78368),
        (44.15643, -40.05483),
        (43.75175, -40.34857),
        (43.50658, -40.60757),
        (43.46812, -41.07141),
        (43.13428, -41.39539),
        (42.68975, -41.69609),
        (42.64801, -42.17286),
        (42.3013, -42.51939),
        (41.96262, -42.6983),
        (41.58315, -43.05793),
        (41.65034, -43.69817),
        (40.99382, -43.77624),
        (40.67824, -44.05928),
        (40.60699, -44.78686),
        (40.04654, -44.75621),
        (39.64466, -45.12347),
        (39.87199, -45.98722),
        (39.48645, -46.31159),
        (39.05951, -46.40771),
        (38.79218, -46.63861),
        (38.55965, -47.09427),
        (38.26655, -47.32609),
        (38.10201, -47.83235),
        (37.95979, -48.19929),
        (37.5746, -48.51655),
        (37.29007, -48.7425),
        (37.07124, -49.27428),
        (36.74185, -49.51266),
        (36.71096, -50.40652),
        (36.29658, -50.71288),
        (35.82384, -51.03599),
        (35.83523, -51.7467),
        (35.38913, -52.05408),
        (34.98146, -52.21786),
        (34.65359, -52.43236),
        (34.53974, -53.21326),
        (34.14288, -53.34702),
        (33.71505, -53.6346),
        (33.39738, -53.84533),
        (33.51597, -55.06672),
        (33.16669, -55.27154),
        (32.48172, -55.22325),
        (32.11273, -55.45124),
        (31.94211, -56.24989),
        (31.57755, -56.45221),
        (31.37244, -56.90453),
        (31.14216, -57.60632),
        (30.8003, -57.79098),
        (30.61147, -58.56283),
        (30.0224, -58.29858),
        (29.55136, -58.5463),
        (29.33729, -58.99976),
        (28.87831, -59.23119),
        (28.62424, -59.56952),
        (28.27514, -60.16595),
        (27.86721, -60.35202),
        (27.69314, -61.31639),
        (27.30364, -61.49556),
        (26.71468, -61.63767),
        (26.25291, -61.61809),
        (25.74874, -61.83754),
        (25.69133, -62.83878),
        (25.19387, -63.14474),
        (24.78116, -63.30665),
        (24.32017, -63.81124),
        (23.9349, -63.96541),
        (23.67162, -64.81703),
        (23.26078, -64.96721),
        (22.89489, -65.20092),
        (22.38418, -65.38041),
        (22.10229, -65.79692),
        (21.74345, -66.33584),
        (21.37791, -66.44506),
        (21.14691, -67.45323),
        (20.92894, -68.04728),
        (20.44803, -68.20413),
        (20.23533, -68.99995),
        (19.67768, -69.16172),
        (19.65733, -71.03991),
        (19.20699, -71.89072),
        (18.7522, -72.01365),
        (18.49625, -73.72312),
        (17.96028, -73.84758),
        (17.66819, -74.8447),
        (17.15516, -75.57951),
        (16.66185, -75.68376),
        (16.15605, -76.60398),
        (15.77005, -77.19592),
        (15.09662, -77.33439),
        (14.80579, -78.41387),
        (14.14272, -78.53603),
        (13.74664, -79.31823),
        (13.03833, -79.44263),
        (12.59219, -79.823),
        (12.04526, -80.51252),
        (11.53285, -80.58154),
        (11.13068, -81.24123),
        (10.49287, -81.32968),
        (9.994428, -81.39335),
        (9.444551, -82.15775),
        (8.979414, -82.2027),
        (8.339405, -82.47269),
        (7.859473, -82.52424),
        (7.199107, -82.69133),
        (6.675219, -82.63404),
        (5.993504, -82.68512),
        (5.29219, -82.94151),
        (-97.07606, -43.5693),
        (-97.45057, -42.73686),
        (-94.96304, -40.92741),
        (-95.28739, -40.15319),
        (-94.88047, -39.31029),
        (-95.18672, -38.56257),
        (-93.38594, -37.14701),
        (-92.88118, -36.25088),
        (-93.16073, -35.52872),
        (-91.49557, -34.28764),
        (-91.11721, -33.31609),
        (-91.31251, -32.77377),
        (-89.39909, -31.26491),
        (-89.586, -30.71833),
        (-88.99661, -29.66788),
        (-89.20154, -29.03948),
        (-88.13657, -27.75125),
        (-86.20979, -26.52291),
        (-86.42331, -25.82488),
        (-85.75781, -24.90814),
        (-84.63279, -23.74291),
        (-84.77924, -23.20426),
        (-83.89979, -22.23959),
        (-84.03999, -21.72571),
        (-83.10987, -20.94639),
        (-83.27892, -20.27172),
        (-82.42499, -19.54336),
        (-81.7839, -18.77633),
        (-81.89162, -18.32652),
        (-81.76069, -17.55483),
        (-80.40648, -16.72704),
        (-80.54389, -16.08975),
        (-79.57537, -15.33393),
        (-79.70953, -14.63342),
        (-78.91404, -13.94745),
        (-79.00442, -13.4164),
        (-78.42203, -12.65547),
        (-77.21679, -11.98842),
        (-77.31683, -11.36601),
        (-77.08769, -10.87309),
        (-76.18275, -10.16508),
        (-76.24742, -9.743527),
        (-76.03002, -9.122801),
        (-75.20463, -8.440422),
        (-75.27287, -7.793787),
        (-74.42327, -7.247854),
        (-74.4819, -6.625099),
        (-73.92911, -6.056911),
        (-73.98458, -5.39445),
        (-73.12295, -4.862887),
        (-72.35773, -4.358078),
        (-72.39491, -3.722221),
        (-71.91841, -3.248844),
        (-70.74347, -2.600505),
        (-70.75871, -2.218132),
        (-70.57655, -1.692656),
        (-70.58747, -1.264886),
        (-69.99698, -0.6531214),
        (-70.00018, -0.2322217),
        (-69.40283, 0.292089),
        (-69.40216, 0.6911534),
        (-69.39969, 1.064593),
        (-68.59319, 1.56976),
        (-68.58461, 1.988341),
        (-68.3757, 2.517091),
        (-67.663, 2.892552),
        (-67.63814, 3.481284),
        (-67.20333, 4.044209),
        (-66.36444, 4.557479),
        (-66.32514, 5.015619),
        (-66.18645, 5.448834),
        (-66.13786, 6.032449),
        (-65.60012, 6.430506),
        (-65.54794, 6.953366),
        (-64.61174, 7.24334),
        (-64.3568, 7.75779),
        (-64.3201, 8.144878),
        (-63.96187, 8.597437),
        (-63.71397, 8.943222),
        (-63.63897, 9.469694),
        (-62.69694, 9.713233),
        (-62.64342, 10.10023),
        (-62.36797, 10.54806),
        (-62.30318, 10.92594),
        (-62.10655, 11.45016),
        (-62.03624, 11.83302),
        (-61.94375, 12.33291),
        (-60.9821, 12.53459),
        (-60.68479, 12.97449),
        (-60.60685, 13.348),
        (-60.23537, 13.65735),
        (-60.11034, 14.16804),
        (-59.9905, 14.61676),
        (-59.60437, 14.94311),
        (-59.49168, 15.44765),
        (-59.3104, 15.78795),
        (-59.17284, 16.30155),
        (-59.06715, 16.69052),
        (-58.53767, 17.10249),
        (-58.4173, 17.50383),
        (-57.63372, 17.66915),
        (-57.57722, 18.18398),
        (-57.46844, 18.53576),
        (-57.03198, 18.92254),
        (-56.92659, 19.25313),
        (-56.49042, 19.60755),
        (-56.36189, 19.97632),
        (-56.10057, 20.41378),
        (-55.97241, 20.76149),
        (-55.83735, 21.11955),
        (-55.28812, 21.43039),
        (-55.10256, 21.90558),
        (-54.95622, 22.27583),
        (-54.35486, 22.42928),
        (-54.16673, 22.86783),
        (-54.29106, 23.33192),
        (-53.34871, 23.49303),
        (-53.1784, 23.89248),
        (-53.40524, 24.36193),
        (-53.26278, 24.66346),
        (-53.06077, 25.09536),
        (-52.89914, 25.44795),
        (-52.33092, 25.70784),
        (-52.08336, 25.98384),
        (-51.86212, 26.43047),
        (-51.60619, 26.72881),
        (-51.47129, 27.21973),
        (-51.29675, 27.56151),
        (-50.80189, 27.85681),
        (-50.62005, 28.18578),
        (-50.5281, 28.55676),
        (-50.3159, 28.92866),
        (-49.97793, 29.10652),
        (-49.73955, 29.49055),
        (-49.56292, 29.77272),
        (-49.40676, 30.21438),
        (-49.04535, 30.41226),
        (-48.79611, 30.8027),
        (-48.77522, 31.20871),
        (-48.57724, 31.51819),
        (-48.02295, 31.82012),
        (-48.00963, 32.37754),
        (-47.80469, 32.67666),
        (-47.27427, 32.92403),
        (-47.06984, 33.22197),
        (-46.79512, 33.61131),
        (-46.75996, 33.99973),
        (-46.49309, 34.37104),
        (-46.05213, 34.46897),
        (-45.91535, 34.82179),
        (-45.64873, 35.17801),
        (-45.69022, 35.61582),
        (-45.40447, 35.98525),
        (-44.8811, 36.00613),
        (-44.58887, 36.36499),
        (-44.68196, 36.87883),
        (-44.61401, 37.42619),
        (-44.37949, 37.70426),
        (-44.2865, 38.27376),
        (-43.99034, 38.46611),
        (-43.68488, 38.81309),
        (-43.34691, 39.03858),
        (-43.08756, 39.31869),
        (-42.74543, 39.68845),
        (-42.47285, 39.97419),
        (-42.10206, 40.36061),
        (-42.1898, 41.13988),
        (-41.91816, 41.42208),
        (-41.31588, 41.31765),
        (-40.99159, 41.64434),
        (-40.86607, 42.05555),
        (-40.99997, 42.90123),
        (-40.73387, 43.1565),
        (-40.38099, 43.49324),
        (-40.52397, 44.18958),
        (-40.15516, 44.5361),
        (-39.64664, 44.58747),
        (-39.26941, 44.90938),
        (-39.19113, 45.37502),
        (-38.9131, 45.6206),
        (-38.52625, 45.94932),
        (-38.36963, 46.33201),
        (-37.9842, 46.64119),
        (-37.95257, 47.18102),
        (-37.51745, 47.40216),
        (-37.22401, 47.62731),
        (-37.12294, 48.33491),
        (-36.83071, 48.5556),
        (-36.43216, 48.85341),
        (-36.10365, 49.09499),
        (-35.93833, 49.8288),
        (-35.61831, 50.05357),
        (-35.1771, 50.36645),
        (-35.25445, 51.16902),
        (-35.00194, 51.70913),
        (-34.6822, 51.91732),
        (-34.50598, 52.50398),
        (-34.19449, 52.70794),
        (-33.76609, 52.98042),
        (-33.52089, 53.24704),
        (-33.14051, 53.47695),
        (-33.21496, 54.24693),
        (-32.90476, 54.43353),
        (-32.61721, 54.95153),
        (-32.21101, 55.07153),
        (-31.76901, 55.33026),
        (-31.84018, 56.21307),
        (-31.50054, 56.75599),
        (-31.14257, 56.95496),
        (-30.98983, 57.83183),
        (-30.59447, 58.04317),
        (-30.18363, 58.49065),
        (-29.80426, 58.69127),
        (-29.75321, 59.61066),
        (-29.4192, 60.33019),
        (-28.96031, 60.54678),
        (-28.76922, 61.08164),
        (-28.2595, 61.3238),
        (-28.1224, 62.05006),
        (-27.95886, 62.7848),
        (-27.44431, 63.01179),
        (-27.33728, 63.82185),
        (-27.05594, 64.69882),
        (-26.66532, 64.85684),
        (-26.22127, 65.25484),
        (-25.83398, 65.41747),
        (-25.42687, 66.01003),
        (-25.02442, 66.15701),
        (-24.79214, 67.19785),
        (-24.49508, 67.62676),
        (-23.95662, 67.8222),
        (-23.74433, 68.53059),
        (-23.54857, 69.43849),
        (-22.9639, 69.62753),
        (-22.64779, 70.15594),
        (-22.04899, 70.35011),
        (-21.88402, 71.3429),
        (-21.30211, 71.5075),
        (-21.09558, 72.50502),
        (-20.67145, 73.56699),
        (-20.0565, 73.7375),
        (-19.82635, 74.83664),
        (-19.47491, 75.3439),
        (-18.87267, 75.50031),
        (-18.65683, 76.78892),
        (-18.01826, 76.93474),
        (-17.7403, 77.91557),
        (-17.25448, 78.84136),
        (-16.77404, 78.94753),
        (-16.33984, 80.16047),
        (-15.83192, 80.25783),
        (-15.48749, 80.92826),
        (-15.08415, 82.22213),
        (-14.57498, 82.31272),
        (-14.01702, 82.90999),
        (-13.52586, 82.98829),
        (-13.04728, 84.37825),
        (-12.58644, 84.64994),
        (-11.90499, 84.74586),
        (-11.4933, 86.01135),
        (-10.7759, 86.10295),
        (-10.45792, 87.96058),
        (-10.06178, 89.32251),
        (-9.276382, 89.40688),
        (-8.517295, 89.67979),
        (-8.087505, 91.5264),
        (-7.342122, 91.59272),
        (-6.872971, 93.0358),
        (-6.043031, 93.08998),
        (-5.505726, 94.12068),
        (-4.731121, 94.16226),
        (-4.235068, 95.99029),
        (-3.488156, 97.8223),
        (-2.900114, 97.84076),
        (-2.131733, 99.16059),
        (-1.572362, 100.6701),
        (-0.8269175, 100.6759),
        (-0.2768651, 102.1756),
        (0.3001146, 102.1689),
        (1.813364, 104.4468),
        (2.444992, 104.4295),
        (3.151611, 106.9073),
        (4.056821, 106.8728),
        (6.243034, 111.6798),
        (6.936791, 111.6402),
        (11.29625, 70.44834),
        (11.85485, 70.34846),
        (12.29619, 70.26909),
        (12.93034, 70.14889),
        (13.56287, 70.52965),
        (13.91589, 70.0473),
        (14.3189, 69.9603),
        (14.82339, 69.64704),
        (15.2353, 69.55612),
        (15.81345, 69.42373),
        (16.14107, 68.93209),
        (16.73424, 68.7899),
        (17.13823, 68.58717),
        (17.70814, 68.43971),
        (18.23576, 68.71153),
        (18.76346, 68.56538),
        (19.23634, 68.01893),
        (19.89767, 68.66188),
        (20.3484, 68.52983),
        (20.78711, 67.97894),
        (21.21334, 67.85361),
        (21.77805, 67.68198),
        (22.25396, 67.73618),
        (22.7883, 67.55012),
        (23.25818, 67.48881),
        (23.81696, 67.29454),
        (24.40946, 67.61434),
        (24.96224, 67.72953),
        (25.51618, 67.5154),
        (25.86472, 66.73097),
        (76.4378, 132.5591),
        (77.23553, 132.0901),
        (77.74743, 131.0913),
        (78.79662, 130.4653),
        (79.9578, 130.5667),
        (80.82471, 129.5421),
        (81.57361, 129.0628),
        (82.43128, 128.2746),
        (83.21041, 127.7718),
        (84.17752, 127.0014),
        (84.74747, 126.2489),
        (85.53058, 125.7152),
        (86.71998, 125.2635),
        (87.48868, 124.7205),
        (88.24607, 123.5599),
        (89.32063, 123.5176),
        (90.30822, 122.7939),
        (90.68628, 121.6434),
        (91.66981, 120.902),
        (93.03039, 121.1179),
        (111.3818, 79.87113),
        (112.0769, 78.88149),
        (111.9107, 77.73003),
        (112.5582, 76.79298),
        (112.6926, 75.87448),
        (113.3364, 74.89664),
        (113.6311, 74.07565),
        (114.8368, 73.50553),
        (115.2681, 72.82816),
        (116.167, 72.13078),
        (116.3425, 71.25678),
        (116.9044, 70.31739),
        (116.6286, 69.21669),
        (117.196, 68.22865),
        (98.5224, 55.53318),
        (98.88615, 54.88545),
        (97.64765, 52.12172),
        (98.09855, 51.24273),
        (97.52243, 50.18047),
        (97.82393, 49.58683),
        (91.48562, 44.55749),
        (91.84976, 43.80604),
        (91.11365, 42.8023),
        (91.44683, 42.08022),
        (91.15104, 41.26597),
        (90.94886, 40.48799),
        (91.2725, 39.77401),
        (91.23833, 39.10827),
        (91.57027, 38.28831),
        (91.5281, 37.57066),
        (89.96972, 36.05772),
        (90.27733, 35.27213),
        (86.56917, 33.20049),
        (86.83837, 32.46595),
        (85.44734, 31.30576),
        (85.03757, 30.37728),
        (85.22356, 29.85262),
        (84.52724, 28.7869),
        (83.8486, 27.97179),
        (84.07481, 27.28063),
        (82.91423, 26.32737),
        (83.07113, 25.83132),
        (82.79537, 24.99703),
        (82.95404, 24.45523),
        (82.57328, 23.62586),
        (82.33068, 23.02554),
        (82.52368, 22.31912),
        (81.68486, 21.56361),
        (81.17389, 20.73619),
        (81.30332, 20.23367),
        (81.17076, 19.52908),
        (81.28722, 19.0331),
        (80.13423, 18.22893),
        (80.27537, 17.56823),
        (78.22678, 16.64279),
        (77.08698, 15.74319),
        (77.17374, 15.28222),
        (77.00325, 14.54913),
        (77.08749, 14.08387),
        (76.60451, 13.37324),
        (76.48455, 12.86985),
        (76.58596, 12.22368),
        (76.06185, 11.66835),
        (75.75458, 11.00866),
        (75.82119, 10.53543),
        (75.50653, 9.831273),
        (75.56734, 9.326632),
        (75.14678, 8.622642),
        (74.60285, 8.101068),
        (74.66594, 7.472926),
        (74.20701, 6.9575),
        (74.24678, 6.462039),
        (73.49946, 5.77054),
        (73.13297, 5.292318),
        (73.16738, 4.687487),
        (72.78842, 4.229608),
        (72.81793, 3.637563),
        (71.74135, 3.143546),
        (71.36153, 2.5721),
        (71.36833, 2.121596),
        (70.67305, 1.637617),
        (70.67517, 1.070589),
        (70.37534, 0.5440406),
    ]

    # Point list with only obstacles and vertical lines
    # point_list = [(356.0, 588.35), (359.70928298318654, 592.1208667605497), (470.2991629246891, 620.1297812718478), (473.32274363831937, 615.8410741687717), (473.72797411774053, 606.1846800068499), (476.3123644763457, 601.5880912811327), (481.4716243655176, 602.2519281225607), (488.79848128714934, 606.8126858191685), (491.2041686366442, 601.9354697543063), (492.8085248208996, 595.8508769242474), (498.20071948986623, 596.4482852435515), (499.59566804805957, 590.3268331686114), (501.83865792341055, 585.8049531235142), (511.1538483662756, 592.1991603226784), (508.170022469017, 579.911388470479), (516.2539637444631, 584.0183262463557), (515.7159476791694, 575.8301427965284), (521.956150280073, 577.0328396058297), (528.87043448282, 578.8632212405606), (525.9722161248636, 568.1600062349274), (536.5344094965731, 574.2286131851732), (540.784205951147, 572.3545073623503), (543.3165858529212, 568.4689604728237), (548.1618979198777, 567.1831683937669), (545.7735714410803, 558.0883277369002), (552.3343977386103, 558.6013817564431), (557.0304578913372, 557.0304578913368), (559.7503838328645, 553.4478582131578), (566.2527763640202, 553.4404990274813), (568.5145043647285, 549.3733204441949), (570.5130131375669, 545.1186606859277), (571.6131115458907, 540.150994104025), (581.933745612931, 542.9086493940595), (587.5341910971019, 541.4938650683973), (588.9179437730411, 536.6696767405534), (591.1272817116652, 532.5385567514415), (592.3138640569184, 527.6920721946284), (597.0269067534144, 525.3965472519513), (598.6654404921542, 520.9152630618132), (709.3166668344107, 588.0856707382654), (718.9765751733253, 586.3519391614759), (703.5361309907246, 568.9704149782183), (717.8559481524641, 570.0010111814594), (716.4603627039947, 561.6029609327416), (708.647715716646, 549.8697223003793), (586.4197939048726, 478.00100082308677), (588.396776671426, 474.41207209456456), (592.315956561405, 471.76999254758346), (704.9691734598225, 520.2124282743548), (715.0017506667136, 518.0955058545576), (710.1385661858035, 509.2494422986948), (710.8621284375787, 502.9887063714283), (717.7760306591193, 499.2372634496085), (717.5491179157492, 492.61802712068504), (717.0159510477395, 485.9737399981196), (707.9674056178146, 476.5053775051657), (716.0224442435194, 472.97838322063296), (702.4271782136551, 462.5749158804489), (712.1969353597169, 459.48477600760043), (707.7258626406415, 452.22130766987505), (709.266493442643, 446.70341909620277), (708.9945903523661, 440.74650321379033), (718.0163228411695, 436.9202353960459), (707.8592364266663, 428.86654490397933), (703.4841149452614, 422.2861400346982), (712.6342038011794, 418.24263252865325), (715.9877079384081, 413.0164516455379), (702.2607742863556, 405.2802058701686), (711.3754860108454, 400.89436426273426), (704.7312012214618, 394.5002830462951), (698.9710968057678, 388.4203139382294), (695.5251209361539, 382.72120652751096), (695.3789890020336, 377.35191616594363), (696.1969191651654, 372.0432794504369), (698.5558859013408, 366.7652524050521), (692.433489914275, 361.28511959249573), (694.925, 356.0000000000008), (686.55, 356.0), (696.9079378446304, 350.64459016253466), (685.5872882805955, 345.64230219398735), (687.5565217467445, 340.36419134820227), (681.0822561172986, 335.5475580263144), (687.8987033330959, 329.8790055548077), (687.1487984761042, 324.6972222824288), (678.6645751646461, 320.3774992620685), (676.7506829349688, 315.4797655886607), (680.4307526337075, 309.82666629405537), (677.1962483615347, 305.1275119689176), (670.4468969086016, 301.1202311908129), (709.647967443584, 288.53804221627684), (714.3710681173012, 281.7849195819003), (718.4066895459453, 274.99250730739595), (719.0100005324623, 268.8490095384942), (705.0289421127054, 266.3845991601438), (705.5556084491116, 260.3724066925473), (707.7075623791771, 253.81950741313327), (717.7915509265385, 244.69838589144192), (705.9174687578839, 242.30492234460093), (711.1840958378278, 234.3933032729609), (714.1697867216524, 227.0509422106228), (707.2826196773906, 223.2613592897927), (713.8012361819481, 214.33646901311812), (711.0007103674566, 208.9538911137164), (717.1823329379295, 199.70244764068264), (702.60666610447, 199.50108942247246), (714.4924781870291, 187.30624468192187), (593.8650541295921, 239.471112384415), (593.4086883699905, 235.0342313443977), (591.8549525299179, 231.12123081921055), (707.5304246995922, 162.7445136340988), (703.2788794723924, 157.91562436072138), (717.5116513416624, 142.2026053848403), (714.0236050122794, 136.6028526757753), (714.7971519420871, 128.3004034736716), (717.1523608472385, 118.7672403430013), (704.2422757983009, 119.3347937553626), (710.8928936760428, 106.57709679492424), (702.3604007167675, 104.35443886228975), (711.5597912798189, 89.0381573144814), (702.9965736847755, 86.84186738830192), (607.6692956064305, 154.37487439814106), (606.6094322128268, 148.67784733423727), (598.6645537721128, 148.74489157662757), (588.309398264549, 151.19171530926872), (590.0932415607285, 142.99153947415783), (580.1214045007122, 145.53599228222518), (579.7322480681254, 139.18836822166048), (568.2381003731437, 143.76189962685595), (565.6611277933508, 139.64649964139363), (567.5592830872605, 130.7122456954133), (560.5116775427839, 131.2446010133731), (552.1781648482602, 133.47955119412526), (549.844006225351, 129.0378294175311), (550.5896084705311, 120.78156981162087), (538.6959041812947, 127.95823497573767), (535.4591853095914, 124.64261237639758), (537.4169710822144, 114.37528043812702), (529.5142064767373, 117.17818326051622), (524.2177864852621, 116.65030016730768), (523.1776486576688, 110.00556019638984), (519.4440929180446, 107.18014852066418), (512.6087765024878, 109.22405557389564), (506.44039924583865, 110.50358067834912), (503.08751708106706, 107.28859129721471), (497.577314504561, 107.78854474928553), (494.8654965598172, 103.40459947736008), (493.87551977187866, 95.5984570943649), (488.58792544893186, 95.78154461079237), (480.94272423907967, 100.96016848398543), (359.73323664208755, 118.35432137491952), (356.00000000000057, 123.9), (356.00000000000006, 118.875), (352.32841457836196, 122.27883715741004), (3.160960112352143, 24.662087052867662), (3.8431449033074614, 35.56191700515768), (9.617460821395014, 50.62271339017133), (3.3997537512656777, 54.850939989294034), (-2.577600356784444, 59.358810770702405), (0.02618045280280512, 70.81119337887577), (-1.3476043469063939, 78.81278498544157), (-1.159160596794095, 87.83731686382953), (-6.035104982787061, 92.96609959912007), (5.750105970347477, 109.84025160027281), (9.432562364601495, 120.47301259551111), (9.996647577570513, 128.7182789192238), (-1.0662796948033701, 129.3988484033822), (-5.62600970668035, 134.39529623984774), (2.428693857457233, 146.89851244514307), (-1.8761839485349014, 151.87102860584807), (4.44766763340516, 162.73246979224598), (121.36022521145026, 231.76463431381688), (122.53401549954734, 237.04313930574773), (117.25936898404069, 239.04217169380507), (-1.9948233081814806, 187.54042329227886), (2.967940795260006, 196.59991319431083), (-4.218690580961265, 200.11945292584932), (6.35779092110397, 211.1734550214317), (7.728972798410325, 218.10974567813764), (-3.3274383425234078, 220.2214756332923), (0.5587675083153272, 228.03328217933426), (-4.978868660648686, 232.40930908649614), (2.7776098479836833, 241.23108828914567), (-3.4259632149087906, 245.42613569639263), (3.788283435836945, 253.6730370824609), (-5.37143682521031, 257.13996183047357), (-2.714773723987321, 263.89770028849614), (0.3313923665363063, 270.61152203560476), (-2.405430822003268, 275.88689459711986), (-1.391845306679329, 281.98770687725613), (6.281181559319748, 289.2875674746173), (1.6315476489764933, 294.15280440198916), (4.778026084372243, 300.37190423169403), (0.5567562883126698, 305.41293520360864), (4.940212939868729, 311.65083530327007), (-3.59022465979848, 316.3008696050362), (-0.2369599840982346, 322.325692786802), (8.225388127198869, 328.62954445534046), (4.869246270723579, 333.90872546659875), (4.815292210246525, 339.43854959175655), (4.773394687481357, 344.9622592599451), (-0.6559948062098897, 350.39719991487254), (-5.550000000000011, 355.9999999999993), (5.5, 356.0), (-4.455526009640209, 361.6624878909114), (-5.196683252166906, 367.35106306185867), (-5.348412267491597, 373.0407585442132), (1.4011033894352636, 378.30947158876506), (6.829703859972426, 383.48029827867765), (3.2475068920142576, 389.34492811658254), (1.9014096190933856, 395.09284832618476), (4.716987132075246, 400.3773646742811), (0.309250373883458, 406.6222901043751), (1.4939623518933445, 412.1482403645644), (5.645868153056881, 417.1465845143716), (6.600424915806514, 422.65153359814207), (0.4686780335019307, 429.62699726156586), (-6.431087465000644, 437.0129462736406), (9.447360370268825, 439.19992767824453), (-4.555081730132031, 448.57481049711697), (-6.601247533744129, 455.19647630823187), (-6.678917738041889, 461.3679659733666), (0.5166829711344008, 465.36094796202366), (-4.3553140242295285, 473.08653916866626), (7.533110209845518, 475.30688305783303), (4.557510776370009, 482.52708165962355), (-1.4331641800939678, 491.06273780805486), (4.939643340746727, 494.99462797991606), (1.9693631416765243, 502.6442912823018), (8.859312835036917, 506.22118963260465), (-2.887825257124234, 518.0440665597276), (1.8959330174242268, 522.6287257539908), (118.47170621131752, 472.3639104268895), (124.31602854791913, 474.048879694776), (122.84053264184885, 479.45158324729675), (-0.9854337828642201, 552.2544029871838), (-6.175909945006367, 562.5814918028939), (-2.8433510579407084, 568.219366226328), (-0.9364888027320148, 574.7309616542144), (-2.670502753259825, 583.6192225070804), (-1.0360095924898474, 590.5288222783515), (1.1617566218594675, 597.1478211830083), (-4.374496782790175, 609.2754383937654), (5.958571958817572, 610.3199840356475), (0.940011631729817, 622.5865800446943), (9.1417034423813, 625.0508738773157), (-2.1980462081094743, 642.9707481916803), (-1.3062535061989138, 651.5894396462082), (2.031023013183983, 658.3180664977021), (6.654522096352821, 663.9894684778594), (8.16998680893272, 672.5009597908105), (-2.7619099854464935, 692.8998581828034), (3.5256599003805604, 697.5713983874255), (352.3036755535952, 591.2959685387523), (355.9999999999995, 592.725)]

    optimal_model = LinearRegressor()
    optimal_model.slope = math.inf
    optimal_model.x_intercept = 712 + 44

    optimal_model_position_error = 20

    while True:
        start_time = time.perf_counter()

        ransac = RANSAC(
            1000, 2, 12, 40, sample=sample, score_model=score_model, compare=compare
        )

        model, inliers = ransac.fit(point_list)

        print(
            f"Linear Regression took: {round((time.perf_counter() - start_time) * 1000)} ms"
        )

        if not model:
            print("Couldn't find any lines")
            break

        fig, ax = plt.subplots()

        x_data = [point[0] for point in point_list]
        y_data = [point[1] for point in point_list]

        plt.scatter(x_data, y_data)
        plt.scatter(
            [point[0] for point in inliers],
            [point[1] for point in inliers],
            color="#11aa00",
        )

        x_data_inliers = [point[0] for point in inliers]
        y_data_inliers = [point[1] for point in inliers]

        x_limit = [min(x_data) - 25, max(x_data) + 25]
        y_limit = [min(y_data) - 25, max(y_data) + 25]
        ax.set_xlim(x_limit)
        ax.set_ylim(y_limit)
        if math.isinf(model.slope):
            x_values = [model.x_intercept, model.x_intercept]
            y_values = y_limit
        else:
            x_values = x_limit
            y_values = model.predict_y(x_values)
        plt.plot(x_values, y_values, c="peru")
        plt.show()

        for point in inliers:
            point_list.remove(point)
